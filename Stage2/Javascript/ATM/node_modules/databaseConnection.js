var mysql = require('mysql2');
var selectCustPin = "SELECT customerpin FROM customers WHERE customeraccountno = ?";

var con = mysql.createConnection({
  host: "localhost",
  user: "abdalghany",
  password: "ohitsme",
  database:"atm"
});

function fetchPasswordFromDb(userAccountNo, callback){
  con.connect(function(err) {
    if (err) throw err;
    // console.log("Connected!");
    con.query(selectCustPin, [userAccountNo], function(err, result, fields) {
      if (err) return callback(err, null);
      if (result && result.length > 0) {
        callback(null, result[0].customerpin);
      } else {
        callback(null, "User does not exist");
      }
    });
  });
}

module.exports.fetchUserPassword = fetchPasswordFromDb;

//console.log(fetchPasswordFromDb("158888899999"));